(self.webpackChunkblog=self.webpackChunkblog||[]).push([[3277],{13277:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var o=n(59713),r=n.n(o),p=n(6479),i=n.n(p),l=(n(67294),n(3905));function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c={};function u(e){var t=e.components,n=i()(e,["components"]);return(0,l.kt)("wrapper",s(s(s({},c),n),{},{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h3",null,"Affix 固钉组件"),(0,l.kt)("p",null,"固钉组件实现的效果其实是 CSS 中的 ",(0,l.kt)("inlineCode",{parentName:"p"},"position: sticky")," 属性, ",(0,l.kt)("inlineCode",{parentName:"p"},"position: sticky")," 本质是 ",(0,l.kt)("inlineCode",{parentName:"p"},"position: relative")," 与 ",(0,l.kt)("inlineCode",{parentName:"p"},"position: absolute")," 的结合体。"),(0,l.kt)("p",null,"开发坑点: 相对定位切换到绝对定位以后 ",(0,l.kt)("inlineCode",{parentName:"p"},"getBoundingClientRect().top")," 获取的 top 是定值, 其值始终与 ",(0,l.kt)("inlineCode",{parentName:"p"},"offsetTop")," 的值相等，这样无法从绝对定位切换到相对定位了。"),(0,l.kt)("p",null,"解决手段: 提供一个占位父节点, 父节点使用 ",(0,l.kt)("inlineCode",{parentName:"p"},"getBoundingClientRect"),", 子节点上绝对定位。",(0,l.kt)("a",s({parentName:"p"},{href:"https://github.com/ming-cult/snake-design/blob/master/components/Affix/index.tsx#L83-L87"}),"demo")),(0,l.kt)("h3",null,"small tip"),(0,l.kt)("pre",null,(0,l.kt)("code",s({parentName:"pre"},{className:"language-js"}),"window.addEventListener('scroll', fn)\n")),(0,l.kt)("p",null,"页面在顶部, 此时刷新浏览器不会执行 fn 函数, 但是页面发生滚动后, 此时刷新浏览器会执行 fn 函数。因此根据浏览器的这个原生特性, 初始化设置「是否吸顶」的逻辑直接写在 fn 中就行，当页面发生滚动或者页面初始化都会调用。"))}u.isMDXComponent=!0}}]);