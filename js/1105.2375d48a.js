(self.webpackChunkblog=self.webpackChunkblog||[]).push([[1105],{81105:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>d});var r=t(59713),a=t.n(r),p=t(6479),s=t.n(p),l=(t(67294),t(3905));function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var u={};function d(e){var n=e.components,t=s()(e,["components"]);return(0,l.kt)("wrapper",c(c(c({},u),t),{},{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,(0,l.kt)("a",c({parentName:"p"},{href:"https://github.com/cdr/code-server"}),"code-server")," æ˜¯ vscode çš„æœåŠ¡ç«¯ç¨‹åºï¼Œé€šè¿‡éƒ¨ç½² code-server åœ¨æœåŠ¡å™¨ï¼Œå¯ä»¥å®ç° web ç«¯è®¿é—® vscodeã€‚è¿›è€Œå¯ä»¥è¾¾åˆ°ä»¥ä¸‹èƒ½åŠ›:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"ã€ç›´æ¥ã€‘æ”¯æŒè·¨è®¾å¤‡(Mac/iPad/iPhone ç­‰ç­‰)ç¼–ç¨‹ï¼ŒåŒæ—¶ä¿è¯å¤šç«¯ç¼–ç¨‹ç¯å¢ƒç»Ÿä¸€ã€‚"),(0,l.kt)("li",{parentName:"ul"},"ã€ç›´æ¥ã€‘æ”¯æŒåœ¨ web ç«¯æäº¤ git ä»£ç ã€‚"),(0,l.kt)("li",{parentName:"ul"},"ã€é—´æ¥ã€‘è§£æ”¾èƒŒåŒ…é‡é‡ğŸ˜ã€‚")),(0,l.kt)("p",null,"è‡³äºå°† code-server éƒ¨ç½²åœ¨æ ‘è“æ´¾ä¸Šç›¸æ¯”äº‘ç«¯æœåŠ¡å™¨å¥½å¤„æ˜¯ç»¼åˆæˆæœ¬ä½ï¼Œåç»­è‹¥è¦æ›´æ¢äº‘æœåŠ¡å™¨ï¼Œåªéœ€æ›´æ”¹å†…ç½‘æ˜ å°„ç«¯å£å³å¯ï¼Œè¿ç§»ä¼šååˆ†ä¾¿æ·ã€‚"),(0,l.kt)("h3",null,"æ ‘è“æ´¾ä¸Šéƒ¨ç½² code-server"),(0,l.kt)("p",null,"å‚è€ƒ ",(0,l.kt)("a",c({parentName:"p"},{href:"https://coder.com/docs/code-server/latest/install#raspberry-pi"}),"code-server å®˜ç½‘"),"ï¼Œåœ¨æ ‘è“æ´¾ä¸Šå…¶æ¨èä½¿ç”¨ ",(0,l.kt)("a",c({parentName:"p"},{href:"https://coder.com/docs/code-server/latest/install#yarn-npm"}),"yarn çš„æ–¹å¼"),"æ¥è¿›è¡Œå®‰è£… code-serverã€‚"),(0,l.kt)("p",null,"æ­¤å¤–",(0,l.kt)("a",c({parentName:"p"},{href:"https://github.com/cdr/code-server/blob/main/docs/npm.md"}),"å‰ç½®å®‰è£…"),"æåˆ° ",(0,l.kt)("inlineCode",{parentName:"p"},"node.js ç‰ˆæœ¬éœ€è¦ä¸æ‰€ä¸‹è½½çš„ VSCode's Electron æ‰€ä¾èµ–çš„ç‰ˆæœ¬ä¸€è‡´"),"ã€‚ç¬”è€…ä¸‹è½½çš„ code-server ç‰ˆæœ¬ä¸º code-server_3.12.0_arm64.debï¼Œå…¶éœ€è¦ node.js 14.x ç‰ˆæœ¬ã€‚æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œå‰ç½®å®‰è£…:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"sudo apt-get install -y \\\n  build-essential \\\n  pkg-config \\\n  python3\nnpm config set python python3\n")),(0,l.kt)("p",null,"æŒ‰ç…§ ",(0,l.kt)("a",c({parentName:"p"},{href:"https://yarn.bootcss.com/docs/install/#debian-stable"}),"yarn å®˜ç½‘")," æ‰€è¿°ï¼Œåœ¨ Debian / Ubuntu ç³»ç»Ÿä¸­å®‰è£… yarn:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),'curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list\nsudo apt update && sudo apt install yarn\n\nyarn --version // 1.22.15\n')),(0,l.kt)("p",null,"æ‰§è¡Œ ",(0,l.kt)("inlineCode",{parentName:"p"},"sudo vim .bashrc"),"ï¼Œå°† yarn å…¨å±€å®‰è£…å‘½ä»¤çš„æ‰§è¡Œè·¯å¾„å†™å…¥ .bashrc æ–‡ä»¶ã€‚"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),'export PATH="$PATH:`yarn global bin`"\nsource ~/.bashrc # ä½¿ä¹‹ç”Ÿæ•ˆ\n')),(0,l.kt)("p",null,"å‚ç…§ ",(0,l.kt)("a",c({parentName:"p"},{href:"https://coder.com/docs/code-server/latest/npm#installing"}),"code-server å®˜ç½‘å®‰è£…æ•™ç¨‹"),"ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… code-server:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"yarn global add code-server\ncode-server --version # 3.12.0\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"ç¬”è€…ä½¿ç”¨ npm install -g code-server æ— æ³•æˆåŠŸå®‰è£…ï¼Œæœ€ç»ˆä½¿ç”¨ yarn global add code-server å®‰è£…æˆåŠŸã€‚")),(0,l.kt)("p",null,"ç¼–è¾‘ ",(0,l.kt)("inlineCode",{parentName:"p"},".config/code-server/config.yaml")),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"sudo vim .config/code-server/config.yaml\n")),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"bind-addr: 127.0.0.1:5555\nauth: password\npassword: xxxxxxxxx\ncert: false\n")),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"# å¯åŠ¨ code-server\ncode-server\n")),(0,l.kt)("p",null,"åœ¨ ",(0,l.kt)("inlineCode",{parentName:"p"},"frpc.ini")," ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®:"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"frpc.ini ä¸ pm2 çš„å®Œæ•´é…ç½®è¯´æ˜å¯ä»¥å‚è€ƒ",(0,l.kt)("a",c({parentName:"p"},{href:"https://muyunyun.cn/blog/fes9wogn"}),"å†…ç½‘ç©¿é€"),"ç« èŠ‚ã€‚")),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"[vscode-server-frp-muyunyun-cn-5555]\ntype = tcp\nlocal_ip = 127.0.0.1\n# code-server æœåŠ¡è¿è¡Œåœ¨æ ‘è“æ´¾æœ¬åœ°çš„ 5555 ç«¯å£ä¸Š\nlocal_port = 5555\n# å¯¹å¤–è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯äº‘ä¸»æœº 5555 ç«¯å£ä¸Š\nremote_port = 5555\n")),(0,l.kt)("p",null,"ä½¿ç”¨ pm2 é‡å¯ frpc æœåŠ¡:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"cd /opt/frp_0.37.0_linux_arm64\npm2 restart start_frpc.sh\n")),(0,l.kt)("p",null,"æ­¤æ—¶åœ¨ frps æœåŠ¡å™¨ç«¯(äº‘ä¸»æœº)ä¸­é€šè¿‡ ",(0,l.kt)("inlineCode",{parentName:"p"},"lsof -i:5555")," å¯ä»¥çœ‹åˆ°æœåŠ¡ç«¯ç«¯å£ 5555 å·²ç»è¢« frps æœåŠ¡å æ®ã€‚"),(0,l.kt)("p",null,(0,l.kt)("img",c({parentName:"p"},{src:"http://with.muyunyun.cn/c4987da142cbc4b261b6b333df5d490b.jpg",alt:null}))),(0,l.kt)("p",null,"åŒæ—¶åœ¨å…¬ç½‘ä¸­å¯ä»¥çœ‹åˆ° code-server æœåŠ¡å·²æˆåŠŸè¿è¡Œ"),(0,l.kt)("p",null,(0,l.kt)("img",c({parentName:"p"},{src:"http://with.muyunyun.cn/9f5f9fa5cd5c1510695ca492e939c255.jpg",alt:null}))),(0,l.kt)("p",null,"ä½¿ç”¨ pm2 å®ˆæŠ¤è¿è¡Œ code-server ä»¥è®©ç›¸å…³æœåŠ¡é‡åˆ°æ„å¤–(æ¯”å¦‚æ–­ç”µå)èƒ½è‡ªåŠ¨é‡å¯:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),'cd /opt/frp_0.37.0_linux_arm64\nsudo touch start_code_server.sh\nsudo chmod 777 start_code_server.sh\nsudo echo "code-server" > start_code_server.sh\npm2 start /opt/frp_0.37.0_linux_arm64/start_code_server.sh\npm2 save\n')),(0,l.kt)("p",null,"ç¬”è€…åœ¨åŸŸåè§£æå¤„æ–°å¢ code ä¸»æœºè®°å½•ä»¥è¯­ä¹‰åŒ–è®¿é—® code-server æœåŠ¡ï¼Œæ­¤æ—¶è®¿é—® ",(0,l.kt)("a",c({parentName:"p"},{href:"http://code.muyunyun.cn:5555"}),"http://code.muyunyun.cn:5555")," ä¸è®¿é—® ",(0,l.kt)("a",c({parentName:"p"},{href:"http://frp.muyunyun.cn:5555"}),"http://frp.muyunyun.cn:5555")," æ•ˆæœæ˜¯ç›¸åŒçš„ã€‚"),(0,l.kt)("p",null,(0,l.kt)("img",c({parentName:"p"},{src:"http://with.muyunyun.cn/b0afbe6f729762ce8e50a00624c3e11a.jpg-400",alt:null}))),(0,l.kt)("h3",null,"æ”¯æŒ HTTPS åè®®è®¿é—®"),(0,l.kt)("p",null,"è®¿é—® HTTP ä¸‹çš„ code-server æœåŠ¡ï¼Œå‘ç°ä¸èƒ½å®Œæ•´ä½¿ç”¨æ’ä»¶ã€å‰ªåˆ‡æ¿ç­‰åŠŸèƒ½æ¨¡å—ã€‚"),(0,l.kt)("p",null,(0,l.kt)("img",c({parentName:"p"},{src:"http://with.muyunyun.cn/580bab3470fb6535fae23530db223a94.jpg-400",alt:null}))),(0,l.kt)("p",null,"æ ¹æ®æ§åˆ¶å°æŠ¥é”™ä¿¡æ¯ï¼Œæ¨æµ‹è¿™äº›æ¨¡å—ä¾èµ–äº† service workï¼ŒæŸ¥é˜… ",(0,l.kt)("a",c({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers#setting_up_to_play_with_service_workers"}),"Setting up to play with service workers")," å¾—çŸ¥, service work ç¡®å®å¿…é¡»åœ¨ Https åè®®ä¸­ä½¿ç”¨ã€‚"),(0,l.kt)("p",null,"å› æ­¤è‹¥è¦å®Œæ•´åœ°ä½¿ç”¨ code-server æœåŠ¡ï¼Œéœ€è¦é…ç½® HTTPS åè®®ï¼Œé…ç½®è¿‡ç¨‹è®°å½•åœ¨ ",(0,l.kt)("a",c({parentName:"p"},{href:"https://muyunyun.cn/blog/mx5pvgl1"}),"HTTPS åŸŸåé…ç½®")," ç« èŠ‚ä¸­ï¼Œå…¶ä»‹ç»äº†ç»™åŸŸåè·å–å…è´¹çš„ Https è¯ä¹¦å¹¶è®© Https ç”Ÿæ•ˆçš„è¿‡ç¨‹ã€‚"),(0,l.kt)("h3",null,"æ”¯æŒåœ¨ HTTPS åè®®ä¸­è®¿é—® WebSocket"),(0,l.kt)("p",null,"åœ¨é…ç½®å®Œ HTTPS æœåŠ¡åï¼Œè®¿é—® HTTPS é“¾æ¥å‘ç°è¿˜æ˜¯æ— æ³•åœ¨ web ç«¯æ­£å¸¸ä½¿ç”¨ vscodeï¼Œæ’æŸ¥å‘ç° code-server ä½¿ç”¨ WebSocket ä»¥ä¿æŒé•¿è¿æ¥ï¼Œå› æ­¤éœ€è¦åœ¨ nginx é…ç½®æ–‡ä»¶ä¸­å¢åŠ å¯¹ ",(0,l.kt)("a",c({parentName:"p"},{href:"http://nginx.org/en/docs/http/websocket.html"}),"WebSocket é…ç½®"),"ã€‚"),(0,l.kt)("p",null,"æ‰§è¡Œ ",(0,l.kt)("inlineCode",{parentName:"p"},"vim /etc/nginx/conf.d/www.muyunyun.cn.conf")," è¿›è¡Œç¼–è¾‘ï¼Œå®Œæ•´çš„ nginx é…ç½®å¦‚ä¸‹:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),'map $http_upgrade $connection_upgrade {\n        default upgrade;\n        \'\' close;\n}\n\nupstream code_muyunyun_cn {\n  server 127.0.0.1:5555;\n}\n\nserver {\n    server_name      code.muyunyun.cn;\n    listen           80;\n    listen           [::]:80;\n    rewrite ^(.*)$ https://$host$1 permanent;\n\n    error_page 404 /404.html;\n        location = /40x.html {\n    }\n\n    error_page 500 502 503 504 /50x.html;\n        location = /50x.html {\n    }\n}\n\nserver {\n    listen       443 ssl http2;\n    listen       [::]:443 ssl http2;\n    server_name  code.muyunyun.cn;\n    root         /usr/share/nginx/html/code.muyunyun.cn;\n\n    location / {\n        proxy_pass http://code_muyunyun_cn;\n        proxy_set_header Host $host:443;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        # support websocket\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n    }\n\n    ssl_certificate "/etc/nginx/ssl/code.muyunyun.cn/fullchain.cer";\n    ssl_certificate_key "/etc/nginx/ssl/code.muyunyun.cn/code.muyunyun.cn.key";\n    ssl_session_cache shared:SSL:1m;\n    ssl_session_timeout  10m;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n    ssl_prefer_server_ciphers on;\n\n    # Load configuration files for the default server block.\n    include /etc/nginx/default.d/*.conf;\n\n    error_page 404 /404.html;\n        location = /40x.html {\n    }\n\n    error_page 500 502 503 504 /50x.html;\n        location = /50x.html {\n    }\n}\n')),(0,l.kt)("p",null,"é‡æ–°åŠ è½½ nginx é…ç½®åï¼Œæ­¤æ—¶å·²ç»å¯ä»¥åœ¨ web ç«¯ä½¿ç”¨ä¸Š code-server çš„èƒ½åŠ›ã€‚"),(0,l.kt)("p",null,(0,l.kt)("img",c({parentName:"p"},{src:"http://with.muyunyun.cn/c8b78a74fccd162ef97ecd2b53da09f4.jpg-400",alt:null}))),(0,l.kt)("h3",null,"åœ¨ web ç«¯ä¸­æäº¤ git ä»£ç "),(0,l.kt)("p",null,"ç™»å…¥æ ‘è“æ´¾ç«¯ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ç”Ÿæˆ ssh å¯†é’¥:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),'# ä»¥ github ä¸ºä¾‹\nssh-keygen -t rsa -C "youremail@example.com" -f ~/.ssh/github\n')),(0,l.kt)("p",null,"ç„¶åå°† ~/.ssh/github.pub å…¬é’¥ä¸­çš„å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œæ‹·è´åˆ° ",(0,l.kt)("a",c({parentName:"p"},{href:"https://github.com/settings/keys"}),"GitHub ssh")," çš„ Key æ–‡æœ¬æ¡†ä¸­ã€‚"),(0,l.kt)("p",null,"ç»éªŒè¯ï¼Œè‡³æ­¤å·²ç»å¯ä»¥åœ¨ web ä¸­æäº¤ä»£ç åˆ° githubã€‚"),(0,l.kt)("p",null,(0,l.kt)("img",c({parentName:"p"},{src:"http://with.muyunyun.cn/924eb6f01775b8a455b6bb5107bd202c.jpg-400",alt:null}))))}d.isMDXComponent=!0}}]);