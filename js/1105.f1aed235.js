(self.webpackChunkblog=self.webpackChunkblog||[]).push([[1105],{81105:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var n=r(59713),a=r.n(n),s=r(6479),o=r.n(s),l=(r(67294),r(3905));function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u={};function d(e){var t=e.components,r=o()(e,["components"]);return(0,l.kt)("wrapper",c(c(c({},u),r),{},{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h3",null,"什么是 code-server"),(0,l.kt)("p",null,"可以通过端口访问在线的 vscode，从而实现远程编程。(比如可以在 ipad 编程)"),(0,l.kt)("h3",null,"树莓派上部署 code-server"),(0,l.kt)("p",null,"参考 ",(0,l.kt)("a",c({parentName:"p"},{href:"https://coder.com/docs/code-server/latest/install#raspberry-pi"}),"code-server 官网"),"描述，其推荐使用 ",(0,l.kt)("a",c({parentName:"p"},{href:"https://coder.com/docs/code-server/latest/install#yarn-npm"}),"yarn 的方式"),"来安装。"),(0,l.kt)("p",null,(0,l.kt)("a",c({parentName:"p"},{href:"https://github.com/cdr/code-server/blob/main/docs/npm.md"}),"前置安装"),"，node.js 版本需要与所下载的 VSCode's Electron 一致。"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"笔者下载的 code-server 版本为 code-server_3.12.0_arm64.deb，其需要 node.js 14.x 版本。")),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"sudo apt-get install -y \\\n  build-essential \\\n  pkg-config \\\n  python3\nnpm config set python python3\n")),(0,l.kt)("p",null,"执行如下命令，安装 yarn。参考 ",(0,l.kt)("a",c({parentName:"p"},{href:"https://yarn.bootcss.com/docs/install/#debian-stable"}),"Debian / Ubuntu 安装")),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),'curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list\nsudo apt update && sudo apt install yarn\n\nyarn --version // 1.22.15\n')),(0,l.kt)("p",null,"执行 ",(0,l.kt)("inlineCode",{parentName:"p"},"sudo vim .bashrc")," 编辑 bashrc，写入 yarn 全局安装命令的执行路径。"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),'export PATH="$PATH:`yarn global bin`"\nsource ~/.bashrc # 使之生效\n')),(0,l.kt)("p",null,(0,l.kt)("a",c({parentName:"p"},{href:"https://coder.com/docs/code-server/latest/npm#installing"}),"安装 code-server"),"，执行如下命令:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"yarn global add code-server\ncode-server --version # 3.12.0\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"笔者使用 npm install -g code-server 安装，无法成功。最终使用 yarn global add code-server 安装成功。")),(0,l.kt)("p",null,"编辑 ",(0,l.kt)("inlineCode",{parentName:"p"},".config/code-server/config.yaml")),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"sudo vim .config/code-server/config.yaml\n")),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"bind-addr: 127.0.0.1:5555\nauth: password\npassword: xxxxxxxxx\ncert: false\n")),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"# 启动 code server\ncode-server\n")),(0,l.kt)("p",null,"在 frpc.ini 中添加以下配置:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"[vscode-server-frp-muyunyun-cn-5555]\ntype = tcp\nlocal_ip = 127.0.0.1\nlocal_port = 5555\nremote_port = 5555\n")),(0,l.kt)("p",null,"重启 frpc 服务，此时在公网中可以看到 code server 服务已成功运行。"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),"cd /opt/frp_0.37.0_linux_arm64\npm2 restart start_frpc.sh\n")),(0,l.kt)("p",null,(0,l.kt)("img",c({parentName:"p"},{src:"http://with.muyunyun.cn/9f5f9fa5cd5c1510695ca492e939c255.jpg",alt:null}))),(0,l.kt)("p",null,"使用 pm2 守护运行 vscode server 服务:"),(0,l.kt)("pre",null,(0,l.kt)("code",c({parentName:"pre"},{className:"language-bash"}),'cd /opt/frp_0.37.0_linux_arm64\nsudo touch start_code_server.sh\nsudo chmod 777 start_code_server.sh\nsudo echo "code-server" > start_code_server.sh\npm2 start /opt/frp_0.37.0_linux_arm64/start_code_server.sh\npm2 save\n')),(0,l.kt)("h3",null,"Https"),(0,l.kt)("p",null,"因为当前域名没有支持 https，vscode-server 中剪切板、插件等功能都不能解锁。"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"service work 必须依赖 https。参考 ",(0,l.kt)("a",c({parentName:"li"},{href:"https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers#setting_up_to_play_with_service_workers"}),"Setting up to play with service workers"))),(0,l.kt)("p",null,"因此接着来支持配置 https，未完待续。"))}d.isMDXComponent=!0}}]);